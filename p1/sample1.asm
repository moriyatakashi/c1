;-------------------------------------------------------------------------------
; NES Sample1 "HELLO, WORLD!" for ASM6F
;-------------------------------------------------------------------------------

; iNESヘッダ（16バイト）
  .db $4E, $45, $53, $1A  ; "NES" Header
  .db $02                 ; 2 x 16KB PRG-ROM
  .db $01                 ; 1 x 8KB CHR-ROM
  .db $01                 ; Vertical mirroring
  .db $00                 ; Mapper, etc.
  .db $00, $00, $00, $00  ; Reserved
  .db $00, $00, $00, $00  ; Reserved

;-------------------------------------------------------------------------------
; PRG-ROM開始位置を指定
;-------------------------------------------------------------------------------
  .org $8000

Reset:
  sei
  ldx #$ff
  txs

  ; スクリーンオフ
  lda #$00
  sta $2000
  sta $2001

  ; パレット転送（BG用のみ）
  lda #$3f
  sta $2006
  lda #$00
  sta $2006
  ldx #$00
  ldy #$10
copypal:
  lda palettes, x
  sta $2007
  inx
  dey
  bne copypal

  ; ネームテーブル転送（中央付近）
  lda #$21
  sta $2006
  lda #$c9
  sta $2006
  ldx #$00
  ldy #$0d
copymap:
  lda string, x
  sta $2007
  inx
  dey
  bne copymap

  ; スクロール設定
  lda #$00
  sta $2005
  sta $2005

  ; スクリーンオン
  lda #$08
  sta $2000
  lda #$1e
  sta $2001

mainloop:
  jmp mainloop

;-------------------------------------------------------------------------------
; パレットデータ
;-------------------------------------------------------------------------------
palettes:
  .db $0f, $00, $10, $20
  .db $0f, $06, $16, $26
  .db $0f, $08, $18, $28
  .db $0f, $0a, $1a, $2a

;-------------------------------------------------------------------------------
; 表示文字列
;-------------------------------------------------------------------------------
string:
  .db "HELLO, WORLD!"

;-------------------------------------------------------------------------------
; ベクタテーブル（PRG-ROM末尾に配置）
;-------------------------------------------------------------------------------
  .pad $fffa
  .dw $0000      ; NMI
  .dw Reset      ; RESET
  .dw $0000      ; IRQ/BRK

;-------------------------------------------------------------------------------
; CHR-ROM（グラフィックパターン）
;-------------------------------------------------------------------------------
  .incbin "character.chr"